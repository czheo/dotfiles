#!/bin/bash

function help {
  echo "usage: work [ls|rm]"
  echo "work  # attach to default session"
  echo "work <session name>  # attach to an existing session"
  echo "work ls  # list all sessions"
  echo "work rm <session name>  # remove a session"
}

function work {
  local session="WORK_"${1:-default}

  if tmux has-session -t "$session" 2>/dev/null; then
    tmux attach-session -t "$session"
  else
    tmux new-session -d -s "$session"
    tmux new-window -t "$session:1" -n agent01
    tmux new-window -t "$session:2" -n agent02
    tmux new-window -t "$session:3" -n agent03
    tmux new-window -t "$session:4"
    tmux select-window -t "$session:0"
    tmux attach-session -t "$session"
  fi
}

case $1 in
ls)
  tmux list-sessions | grep WORK_ | cut -d: -f1 | sed 's/WORK_//'
  ;;
rm)
  tmux kill-session -t WORK_$2
  ;;
help | -h | --help)
  help
  ;;
*)
  work $1
  ;;
esac
